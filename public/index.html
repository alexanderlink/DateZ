<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="DateZ">
  <title>DateZ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
</head>

<body>

<div id="container" class="container">
    <div id="carddeck" class="card-deck">
    </div>
</div>

<script>

$().ready(function() {
    $.getJSON( "data.json", function( data ) {
        Object.keys(data).forEach(function(name) {
            var date = new Date(data[name]);
            var daysLeft = getDaysLeft(date);
            var yearsOld = getYearsOld(date);

            //var element = newJumbo(name, date, yearsOld, daysLeft);
            //$('#container').append(element);

            var element = newCard(name, date, yearsOld, daysLeft);
            $('#carddeck').append(element);
        });
    });
});

function newJumbo(name, date, yearsOld, daysLeft) {
    var jumbo = $( "<div class='jumbotron'></div>" );
    jumbo.append("<h1>" + name + "</h1>");
    jumbo.append("<h2><b>" + date.toLocaleDateString("de-DE") + "</b></h2>");
    jumbo.append("<h2>" + yearsOld + " years old &nbsp;&nbsp;&ndash;&nbsp;&nbsp; next in " + daysLeft + " days</h2>");
    return jumbo;
}

function newCard(name, date, yearsOld, daysLeft) {
    var card = $( "<div class='card bg-light' style='width: 18rem;'></div>" );
    var cardBody = $( "<div class='card-body'></div>" );
    var cardHeader = $( "<div class='card-header'><h5><b>" + name + "</b></h5></div>" );
    //var cardText = $( "<p class='card-text'>" + yearsOld + " years old &nbsp;&nbsp;&ndash;&nbsp;&nbsp; next in " + daysLeft + " days" + "</p>" );
    var cardText = $( "<div class='container'><div class='row'><div class='col'>" + yearsOld + " years</div><div class='col'>-" + daysLeft + " days" + "</div></div></div>" );
    var cardFooter = $( "<div class='card-footer'><h5>" + date.toLocaleDateString("de-DE") + "</h5></div>" );
    card.append(cardHeader);
    card.append(cardBody);
    cardBody.append(cardText);
    card.append(cardFooter);
    return card;
}

function getDaysLeft(date) {
    var one_day = 86400000.0;
    var today = new Date();
    var other = new Date(date);
    other.setFullYear(today.getFullYear());
    var diff = other.getTime() - today.getTime();
    var daysLeft = Math.ceil(diff / one_day); 
    if(daysLeft < 0) {
        other.setFullYear(today.getFullYear() + 1);
        diff = other.getTime() - today.getTime();
        daysLeft = Math.ceil(diff / one_day); 
    }
    return daysLeft;
}

function getYearsOld(date) {
    var today = new Date();
    var other = new Date(date);
    var years = today.getFullYear() - other.getFullYear();
    other.setFullYear(today.getFullYear());
    if(other.getTime() - today.getTime() > 0) years -= 1;
    return years;
}
	
</script>

</body>
</html>